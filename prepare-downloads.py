import csv
import pandas as pd

LIST_PATH='./androzoo/list.csv'
NROWS=50000

print(f'Reading .apk list from {LIST_PATH}')
print(f'Reading first {NROWS} rows')

df = pd.read_csv(LIST_PATH, nrows=NROWS)

print(f'Sample:')
print(df.head(5))

with open('./androzoo/to_download', 'w') as f:
    f.write(';False\n'.join(df[df['vt_detection'] == 0.0]['sha256'].to_list()[:6500]))
    f.write(';False\n')

    f.write(';True\n'.join(df[df['vt_detection'] > 0.0]['sha256'].to_list()[:3500]))
    f.write(';True')